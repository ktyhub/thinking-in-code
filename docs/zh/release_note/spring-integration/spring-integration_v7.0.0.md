# spring-integration v7.0.0
### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Spring Integration

æƒ³è±¡ä¸€ä¸‹è¿™ä¸ªåœºæ™¯ï¼šä½ çš„åº”ç”¨æ˜¯ä¸€åº§ç¹å¿™çš„å›½é™…æœºåœºï¼Œè€Œå„ç§æ•°æ®ã€æ¶ˆæ¯å’Œäº‹ä»¶æ˜¯æ¥è‡ªä¸–ç•Œå„åœ°çš„èˆªç­ã€‚èµ·åˆï¼Œåªæœ‰å‡ æ¡èˆªçº¿ï¼Œä½ æ‰‹åŠ¨è°ƒåº¦å°šå¯åº”ä»˜ã€‚ä½†éšç€ä¸šåŠ¡çˆ†ç‚¸å¼å¢é•¿â€”â€”è®¢å•æ¥äº†ã€æ”¯ä»˜å“äº†ã€ç‰©æµåŠ¨äº†ã€é€šçŸ¥å‘äº†â€”â€”ä½ çš„æœºåœºç¬é—´è¢«æ•°ç™¾æ¶ä¸åŒå…¬å¸ã€ä¸åŒæœºå‹çš„é£æœºæŒ¤æ»¡ï¼Œå®ƒä»¬è®²ç€ä¸åŒçš„åè®®ï¼ˆHTTPã€JMSã€FTPã€TCPï¼‰ï¼Œæœ‰ç€ä¸åŒçš„ç›®çš„åœ°ã€‚ä½ ç”¨ä¸€å †è‡ªå®šä¹‰çš„ `if-else`ã€ä¸´æ—¶æ¶ˆæ¯é˜Ÿåˆ—å’Œæ‰‹å·¥ç²˜åˆä»£ç å‹‰å¼ºç»´æŒï¼Œä½†ç³»ç»Ÿå˜å¾—è„†å¼±ã€ç¬¨é‡ä¸”éš¾ä»¥ç»´æŠ¤ï¼Œæ¯ä¸€æ¬¡æ–°èˆªçº¿çš„å¼€é€šï¼ˆæ–°éœ€æ±‚ï¼‰éƒ½åƒæ˜¯ä¸€æ¬¡å±é™©çš„ç©ºä¸­äº¤é€šç®¡åˆ¶å®éªŒã€‚

è¿™å°±æ˜¯ç°ä»£ä¼ä¸šåº”ç”¨é›†æˆçš„çœŸå®çŸ›ç›¾ï¼š**ä¸šåŠ¡éœ€æ±‚è¦æ±‚ä½ å¿«é€Ÿã€çµæ´»åœ°è¿æ¥ä¸€åˆ‡ï¼Œè€ŒæŠ€æœ¯å¤æ‚æ€§å´è¯•å›¾å°†ä½ æ‹–å…¥æ··ä¹±ã€è€¦åˆçš„æ³¥æ½­**ã€‚

Spring Integration å°±æ˜¯ä½ ä¸€ç›´åœ¨å¯»æ‰¾çš„â€œç©ºä¸­äº¤é€šæ§åˆ¶ç³»ç»Ÿâ€ã€‚å®ƒä¸ç”Ÿäº§â€œé£æœºâ€ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œä½†ä¸ºæ‰€æœ‰â€œé£æœºâ€çš„èµ·é™ã€æ»‘è¡Œã€ä¸­è½¬æä¾›äº†æ ‡å‡†åŒ–ã€å¯é¢„æµ‹ä¸”é«˜å¯é çš„é€šé“ã€‚å®ƒä¼˜é›…åœ°è§£å†³äº†æ ¸å¿ƒçŸ›ç›¾ï¼šé€šè¿‡ä¸€å¥—å£°æ˜å¼çš„ã€åŸºäºæ¨¡å¼çš„ä¼ä¸šé›†æˆèŒƒå¼ï¼Œå°†ä½ çš„æ³¨æ„åŠ›ä»â€œå¦‚ä½•è¿æ¥â€çš„ç¹çç»†èŠ‚ä¸­è§£æ”¾å‡ºæ¥ï¼Œè®©ä½ èƒ½é‡æ–°ä¸“æ³¨äºâ€œè¿æ¥ä»€ä¹ˆâ€çš„ä¸šåŠ¡ä»·å€¼ã€‚ä½¿ç”¨å®ƒï¼Œæ„å‘³ç€é€‰æ‹©ç§©åºè€Œéæ··æ²Œï¼Œé€‰æ‹©å¯ç»´æŠ¤çš„å¼¹æ€§è€Œéè„†å¼±çš„â€œèƒ½è·‘å°±è¡Œâ€ã€‚

### Spring Integration æ˜¯ä»€ä¹ˆ

ç®€å•æ¥è¯´ï¼ŒSpring Integration æ˜¯ Spring å®¶æ—ä¸­çš„â€œè¿æ¥å™¨â€ä¸â€œè·¯ç”±å™¨â€ã€‚å®ƒæ‰©å±•äº† Spring ç¼–ç¨‹æ¨¡å‹ï¼Œä¸ºæ„å»ºåŸºäºæ¶ˆæ¯é©±åŠ¨çš„ä¼ä¸šé›†æˆè§£å†³æ–¹æ¡ˆæä¾›äº†ä¸€å¥—å¼ºå¤§çš„æŠ½è±¡ã€‚

å…¶æ ¸å¿ƒæ€æƒ³æ˜¯**é€šè¿‡æ¶ˆæ¯ç®¡é“ï¼ˆMessage Channelï¼‰å°†åº”ç”¨ç¨‹åºçš„ä¸åŒç»„ä»¶è¿æ¥èµ·æ¥**ï¼Œè®©è¿™äº›ç»„ä»¶æ— éœ€å½¼æ­¤ç›´æ¥è°ƒç”¨ï¼Œåªéœ€å‘ç®¡é“å‘é€æˆ–æ¥æ”¶æ¶ˆæ¯å³å¯é€šä¿¡ã€‚å®ƒæä¾›äº†å¤§é‡çš„é€‚é…å™¨ï¼ˆAdapterï¼‰æ¥è¿æ¥å¤–éƒ¨ç³»ç»Ÿï¼ˆå¦‚ HTTPã€JMSã€æ–‡ä»¶ã€æ•°æ®åº“ï¼‰ï¼Œä»¥åŠä¸°å¯Œçš„å¤„ç†å™¨ï¼ˆFilterã€Transformerã€Routerã€Splitter ç­‰ï¼‰æ¥åœ¨ç®¡é“ä¸­å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å·¥å’Œè·¯ç”±ã€‚

ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¼ä¸šå†…éƒ¨çš„â€œç¥ç»ç³»ç»Ÿâ€æˆ–â€œè£…é…çº¿â€ï¼Œå®ƒè´Ÿè´£åœ¨å¤æ‚çš„ç³»ç»Ÿç¯å¢ƒä¸­å¯é åœ°ä¼ è¾“ã€è½¬æ¢å’Œæ´¾å‘ä¿¡æ¯ï¼Œè®©æ•´ä¸ªæ¶æ„æ¾è€¦åˆä¸”æ˜“äºæ‰©å±•ã€‚

### å…¥é—¨ç¤ºä¾‹

**çœŸå®åœºæ™¯**ï¼šä¸€ä¸ªç”µå•†ç³»ç»Ÿéœ€è¦å¤„ç†ç”¨æˆ·ä¸Šä¼ çš„è®¢å•æ‰¹é‡æ–‡ä»¶ï¼ˆCSVæ ¼å¼ï¼‰ã€‚æµç¨‹æ˜¯ï¼šç›‘æ§æŒ‡å®šç›®å½• -> è¯»å–æ–°æ–‡ä»¶ -> è§£æéªŒè¯å†…å®¹ -> å°†æœ‰æ•ˆè®¢å•æ•°æ®å­˜å…¥æ•°æ®åº“ -> å‘é€å¤„ç†æˆåŠŸé€šçŸ¥é‚®ä»¶ã€‚

**å¼€å‘ç¤ºä¾‹**ï¼ˆåŸºäº Java DSL é…ç½®ï¼‰ï¼š

```java
import org.springframework.context.annotation.*;
import org.springframework.integration.config.*;
import org.springframework.integration.dsl.*;
import org.springframework.integration.file.dsl.*;
import java.io.File;

@Configuration
@EnableIntegration
public class FileProcessingIntegrationConfig {

    @Bean
    public IntegrationFlow fileProcessingFlow() {
        return IntegrationFlows
                // 1. ç›‘æ§ /tmp/input ç›®å½•ï¼Œæ¯2ç§’è½®è¯¢ä¸€æ¬¡æ–°æ–‡ä»¶
                .from(Files.inboundAdapter(new File("/tmp/input"))
                                .patternFilter("*.csv"),
                      e -> e.poller(Pollers.fixedDelay(2000)))
                // 2. å°†æ–‡ä»¶å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²
                .transform(Files.toStringTransformer())
                // 3. å°†CSVå­—ç¬¦ä¸²è½¬æ¢ä¸ºè®¢å•å¯¹è±¡åˆ—è¡¨ï¼ˆè‡ªå®šä¹‰è½¬æ¢å™¨ï¼‰
                .transform(csvToOrderListTransformer())
                // 4. æ‹†åˆ†åˆ—è¡¨ï¼Œè®©æ¯ä¸ªè®¢å•ä½œä¸ºç‹¬ç«‹æ¶ˆæ¯ç»§ç»­å¤„ç†
                .split()
                // 5. è¿‡æ»¤æ‰æ— æ•ˆè®¢å•ï¼ˆè‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼‰
                .filter(Order.class, Order::isValid)
                // 6. å°†è®¢å•æ•°æ®å­˜å…¥æ•°æ®åº“ï¼ˆè‡ªå®šä¹‰æœåŠ¡æ¿€æ´»å™¨ï¼‰
                .handle(orderService, "saveOrder")
                // 7. å¤„ç†æˆåŠŸåï¼Œå‡†å¤‡é‚®ä»¶é€šçŸ¥å†…å®¹
                .transform(order -> "è®¢å• " + ((Order) order).getId() + " å·²æˆåŠŸå¤„ç†ã€‚")
                // 8. å‘é€é‚®ä»¶ï¼ˆæ­¤å¤„ç®€åŒ–ï¼Œå®é™…éœ€é…ç½®é‚®ä»¶é€‚é…å™¨ï¼‰
                .handle(mailService, "sendNotification")
                .get();
    }

    // æ­¤å¤„çœç•¥äº† csvToOrderListTransformer, orderService, mailService ç­‰Beançš„å®šä¹‰
}
```

è¿™ä¸ªæµç¨‹æ¸…æ™°å®šä¹‰äº†æ•°æ®ä»æ–‡ä»¶åˆ°æœ€ç»ˆé€šçŸ¥çš„â€œæ—…ç¨‹â€ï¼Œæ¯ä¸ªæ­¥éª¤èŒè´£å•ä¸€ï¼Œé€šè¿‡ Spring Integration çš„ç®¡é“è¿æ¥ï¼Œæ˜“äºæµ‹è¯•ã€ä¿®æ”¹å’Œç›‘æ§ã€‚

### Spring Integration v7.0.0 ç‰ˆæœ¬æ›´æ–°äº†ä»€ä¹ˆ

Spring Integration 7.0.0 æ˜¯ä¸€ä¸ªé‡è¦çš„ä¸»ç‰ˆæœ¬æ›´æ–°ã€‚å…¶ä¸»è¦å˜åŒ–åŒ…æ‹¬ï¼šå…¨é¢è½¬å‘ Spring Framework 6.3 å’Œ Java 21 åŸºçº¿ï¼Œä¸ºç°ä»£ Java å¼€å‘é“ºå¹³é“è·¯ã€‚å®ƒå¼•å…¥äº†å¯¹ Jakarta EE 10 çš„å…¨é¢æ”¯æŒï¼Œå¹¶ç§»é™¤äº†é•¿æœŸåºŸå¼ƒçš„ API å’Œç»„ä»¶ï¼Œä½¿ä»£ç åº“æ›´ç²¾ç®€ã€‚æ€§èƒ½æ–¹é¢ï¼Œå®ƒä¼˜åŒ–äº†æ¶ˆæ¯ä¼ é€’æ ¸å¿ƒå¹¶æä¾›äº†å¯¹ Project Reactor çš„æ›´æ·±å…¥é›†æˆã€‚æ­¤å¤–ï¼Œè¯¥ç‰ˆæœ¬å‡çº§äº†ä¼—å¤šå…³é”®ä¾èµ–ï¼ˆå¦‚ Reactorã€AMQPã€Kafka å®¢æˆ·ç«¯ï¼‰ï¼Œå¹¶ç»§ç»­å¢å¼ºå…¶ Kotlin DSLï¼Œä¸ºå¼€å‘è€…æä¾›äº†æ›´ç°ä»£åŒ–ã€æ›´é«˜æ•ˆçš„é›†æˆå¼€å‘ä½“éªŒã€‚

### æ›´æ–°æ—¥å¿—

## â­ æ–°åŠŸèƒ½

*   **è°ƒæ•´**ï¼šå¯¹é½ SQL Server DDL åˆ—ç±»å‹ï¼Œä»¥é™ä½æ½œåœ¨çš„éšå¼è½¬æ¢é£é™© [#10586](https://github.com/spring-projects/spring-integration/pull/10586)
*   å°½å¯èƒ½ä¼˜åŒ– `new ArrayList()` çš„åˆ†é… [#10573](https://github.com/spring-projects/spring-integration/pull/10573)

## ğŸ é”™è¯¯ä¿®å¤

*   ä¿®å¤ CompositeExecutor æ„é€ å‡½æ•°ä¸­ä¸æ­£ç¡®çš„ç©ºæ£€æŸ¥ [#10575](https://github.com/spring-projects/spring-integration/pull/10575)
*   ä¿®å¤ Redis[Clustered] åœ¨è§£é”æ—¶å‡ºç° â€œCROSSSLOT Keys in requestâ€ é”™è¯¯çš„é—®é¢˜ [#10546](https://github.com/spring-projects/spring-integration/issues/10546)
*   ä¿®å¤ç”¨äºè‡ªåŠ¨åˆ›å»ºè¾“å…¥ç›®å½•çš„ Files DSL [#10525](https://github.com/spring-projects/spring-integration/pull/10525)

## ğŸ“” æ–‡æ¡£

*   é€šè¿‡ DSL ç¤ºä¾‹æ‰©å±•é‚®ä»¶ç›¸å…³æ–‡æ¡£ [#10572](https://github.com/spring-projects/spring-integration/pull/10572)

## ğŸ”¨ ä¾èµ–å‡çº§

*   å°† org.springframework.ws:spring-ws-bom ä» 5.0.0-SNAPSHOT å‡çº§è‡³ 5.0.0 [#10597](https://github.com/spring-projects/spring-integration/pull/10597)
*   å°† protobufVersion ä» 4.33.0 å‡çº§è‡³ 4.33.1 [#10577](https://github.com/spring-projects/spring-integration/pull/10577)
*   å°† tools.jackson:jackson-bom ä» 3.0.1 å‡çº§è‡³ 3.0.2 [#10562](https://github.com/spring-projects/spring-integration/pull/10562)
*   å°† tools.jackson:jackson-bom ä» 3.0.0 å‡çº§è‡³ 3.0.1 [#10527](https://github.com/spring-projects/spring-integration/pull/10527)
*   å°† graalvmVersion ä» 25.0.0 å‡çº§è‡³ 25.0.1 [#10526](https://github.com/spring-projects/spring-integration/pull/10526)

### æ€»ç»“

æ€»è€Œè¨€ä¹‹ï¼Œè¿™æ˜¯ä¸€æ¬¡å…¸å‹çš„ç»´æŠ¤æ€§æ›´æ–°ï¼Œä¾§é‡äº**ä¿®å¤å·²çŸ¥ç¼ºé™·ã€ä¼˜åŒ–å†…éƒ¨ç»†èŠ‚ã€å®Œå–„ä½¿ç”¨æ–‡æ¡£å¹¶ä¿æŒä¾èµ–ç‰ˆæœ¬çš„æœ€æ–°